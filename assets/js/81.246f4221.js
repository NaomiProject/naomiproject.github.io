(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{369:function(t,s,e){"use strict";e.r(s);var a=e(1),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),e("p",[t._v("It's been a few months since I have built DeepSpeech (today is August 13th, 2018), so these instructions probably need to be updated.\nThey are for building DeepSpeech on Debian or a derivative, but should be fairly easy to translate to other systems by just changing the package manager and package names.")]),t._v(" "),t._m(1),e("p",[t._v("Apparently you need bazel in order to build bazel, so download a copy and unzip it")]),t._v(" "),t._m(2),e("p",[t._v("The script is in 555 mode when you unzip it, so you have to make it writable")]),t._v(" "),t._m(3),e("p",[t._v("If you are building for the Raspberry Pi, do these things (note that DeepSpeech did not run very well on the Raspberry Pi the last time I checked. The language model was too large to fit in memory, and without it DeepSpeech just returns raw phonemes):")]),t._v(" "),t._m(4),t._v(" "),e("p",[t._v("It also sounds like maybe the cc_configure.bzl script has some trouble figuring out the platform, so you give it a little help by editing the _get_cpu_value function and just tell it to always return “arm”")]),t._v(" "),e("p",[t._v("Now build it")]),t._v(" "),t._m(5),e("p",[t._v("I recommend using PocketSphinx for passive listening and DeepSpeech for active listening. To use it as the active listener with Naomi, you will need to add a section like this to your profile.yml file:")]),t._v(" "),t._m(6),e("DocPreviousVersions"),t._v(" "),e("EditPageLink")],1)},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"deepspeech-setup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deepspeech-setup","aria-hidden":"true"}},[this._v("#")]),this._v(" DeepSpeech setup")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pkg-config "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("zip")]),t._v(" g++ zlib1g-dev "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://github.com/bazelbuild/bazel/releases/download/0.4.5/bazel-0.4.5-dist.zip\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v(" -d bazel-0.4.5-dist bazel-0.4.5-dist.zip\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" bazel-0.4.5-dist\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("[")]),this._v("~/bazel-0.4.5-dist"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("]")]),this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("chmod")]),this._v(" a+w scripts/bootstrap/compile.sh\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("vi scripts/bootstrap/compile.sh")]),this._v(" "),s("li",[this._v("Goto line 117 and add -J-Xmx500M")]),this._v(" "),s("li",[this._v("Save and quit")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/bazel-0.4.5-dist"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ ./compile.sh\nBuild successful"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" Binary is here: ~/bazel-0.4.5-dist/output/bazel\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/bazel-0.4.5-dist"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" -iv output/bazel /usr/local/bin/\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/bazel-0.4.5-dist"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/mozilla/tensorflow.git\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/mozilla/DeepSpeech.git\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" tensorflow/\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ln")]),t._v(" -s "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/DeepSpeech/native_client/ ./\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ ./configure\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ bazel build -c opt --copt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("-O3 //native_client:libctc_decoder_with_kenlm.so\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ bazel build --config"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("monolithic -c opt --copt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("-O3 --copt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("-fvisibility"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("hidden --incompatible_load_argument_is_label"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false //native_client:libdeepspeech.so //native_client:deepspeech_utils //native_client:libctc_decoder_with_kenlm.so //native_client:generate_trie\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" native_client\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow/native_client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deepspeech\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow/native_client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PREFIX")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow/native_client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" bindings\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("~/tensorflow/native_client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ pip "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" dist/deepspeech-*.whl\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("active_stt")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("engine")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deepspeech"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("stt\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deepspeech")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("model")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/user/models/output_graph.pb'")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("alphabet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/user/models/alphabet.txt'")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language_model")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/user/models/lm.binary'")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trie")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/user/models/trie'")]),t._v("\n")])])])}],!1,null,null,null);s.default=n.exports}}]);